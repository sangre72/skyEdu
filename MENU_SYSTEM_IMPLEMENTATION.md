# ë©”ë‰´ ê´€ë¦¬ ì‹œìŠ¤í…œ êµ¬í˜„ ì™„ë£Œ

ê´€ë¦¬ì ë©”ë‰´ ê´€ë¦¬ ì‹œìŠ¤í…œì´ ì„±ê³µì ìœ¼ë¡œ í†µí•©ë˜ì—ˆìŠµë‹ˆë‹¤.

## ğŸ“‹ êµ¬í˜„ ë‚´ìš©

### Backend (FastAPI + PostgreSQL)

#### 1. ë°ì´í„°ë² ì´ìŠ¤ ëª¨ë¸
- **íŒŒì¼**: `backend/app/models/menu.py`
- **í…Œì´ë¸”**: `menus`
- **ì£¼ìš” í•„ë“œ**:
  - íŠ¸ë¦¬ êµ¬ì¡°: `parent_id`, `depth`, `sort_order`, `path`
  - ë©”ë‰´ ì •ë³´: `menu_name`, `menu_code`, `description`, `icon`
  - ë§í¬ ì„¤ì •: `link_type`, `link_url`, `external_url`
  - ê¶Œí•œ ì„¤ì •: `permission_type`
  - ìƒíƒœ: `is_visible`, `is_expandable`, `default_expanded`, `is_active`, `is_deleted`
  - ê°ì‚¬ ì»¬ëŸ¼: `created_at`, `created_by`, `updated_at`, `updated_by` (coding-guide ì¤€ìˆ˜)

#### 2. Pydantic ìŠ¤í‚¤ë§ˆ
- **íŒŒì¼**: `backend/app/schemas/menu.py`
- **ìŠ¤í‚¤ë§ˆ**:
  - `MenuBase`: ê¸°ë³¸ ìŠ¤í‚¤ë§ˆ
  - `MenuCreate`: ë©”ë‰´ ìƒì„±
  - `MenuUpdate`: ë©”ë‰´ ìˆ˜ì • (ë¶€ë¶„ ì—…ë°ì´íŠ¸)
  - `MenuResponse`: API ì‘ë‹µ
  - `MenuTreeNode`: íŠ¸ë¦¬ êµ¬ì¡° (ì¬ê·€)
  - `MenuMove`: ë©”ë‰´ ì´ë™
  - `MenuReorder`: ìˆœì„œ ë³€ê²½

#### 3. API ì—”ë“œí¬ì¸íŠ¸
- **íŒŒì¼**: `backend/app/api/v1/endpoints/menus.py`
- **ë¼ìš°í„°**: `/api/v1/admin/menus`
- **ì—”ë“œí¬ì¸íŠ¸**:
  - `GET /api/v1/admin/menus` - ë©”ë‰´ ëª©ë¡ ì¡°íšŒ
  - `GET /api/v1/admin/menus/tree` - íŠ¸ë¦¬ êµ¬ì¡° ì¡°íšŒ
  - `GET /api/v1/admin/menus/{id}` - ë©”ë‰´ ìƒì„¸ ì¡°íšŒ
  - `POST /api/v1/admin/menus` - ë©”ë‰´ ìƒì„±
  - `PATCH /api/v1/admin/menus/{id}` - ë©”ë‰´ ìˆ˜ì •
  - `DELETE /api/v1/admin/menus/{id}` - ë©”ë‰´ ì‚­ì œ (Soft Delete)
  - `PUT /api/v1/admin/menus/{id}/move` - ë©”ë‰´ ì´ë™
  - `PUT /api/v1/admin/menus/reorder` - ìˆœì„œ ì¼ê´„ ë³€ê²½

#### 4. ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜
- **íŒŒì¼**: `backend/alembic/versions/f72dc939c68d_add_menus_table.py`
- **ì ìš© ìƒíƒœ**: âœ… ì™„ë£Œ (`alembic upgrade head`)
- **ìƒì„±ëœ í…Œì´ë¸”**:
  - `menus` - ë©”ë‰´ í…Œì´ë¸”
  - `user_groups` - ì‚¬ìš©ì ê·¸ë£¹ (ê¸°ì¡´ ëˆ„ë½ í…Œì´ë¸” ì¶”ê°€)

---

### Frontend (Next.js 15 + TypeScript + MUI)

#### 1. TypeScript íƒ€ì… ì •ì˜
- **íŒŒì¼**: `frontend/src/types/menu.ts`
- **íƒ€ì…**:
  - `MenuType`: ë©”ë‰´ íƒ€ì… (site/user/admin ë“±)
  - `LinkType`: ë§í¬ íƒ€ì… (url/new_window/modal ë“±)
  - `PermissionType`: ê¶Œí•œ íƒ€ì…
  - `Menu`: ë©”ë‰´ ì¸í„°í˜ì´ìŠ¤
  - `MenuTreeNode`: íŠ¸ë¦¬ ë…¸ë“œ
  - `MenuFormData`: í¼ ë°ì´í„°
  - `MenuListResponse`: ëª©ë¡ ì‘ë‹µ

#### 2. API í´ë¼ì´ì–¸íŠ¸
- **íŒŒì¼**: `frontend/src/lib/api.ts`
- **ì¶”ê°€ëœ ë©”ì„œë“œ**:
  - `getMenus()` - ë©”ë‰´ ëª©ë¡ ì¡°íšŒ
  - `getMenusTree()` - íŠ¸ë¦¬ êµ¬ì¡° ì¡°íšŒ
  - `getMenu()` - ë©”ë‰´ ìƒì„¸ ì¡°íšŒ
  - `createMenu()` - ë©”ë‰´ ìƒì„±
  - `updateMenu()` - ë©”ë‰´ ìˆ˜ì •
  - `deleteMenu()` - ë©”ë‰´ ì‚­ì œ
  - `moveMenu()` - ë©”ë‰´ ì´ë™
  - `reorderMenus()` - ìˆœì„œ ë³€ê²½

#### 3. ê´€ë¦¬ì ë©”ë‰´ í˜ì´ì§€
- **íŒŒì¼**: `frontend/src/app/admin/menus/page.tsx`
- **ê²½ë¡œ**: `/admin/menus`
- **ê¸°ëŠ¥**:
  - ì¢Œì¸¡: ë©”ë‰´ ëª©ë¡ (ì¹´ë“œ í˜•íƒœ)
  - ìš°ì¸¡: ë©”ë‰´ ìƒì„¸/ìˆ˜ì • í¼
  - CRUD ê¸°ëŠ¥ ì™„ë¹„
  - ì‹¤ì‹œê°„ í”¼ë“œë°± (ì„±ê³µ/ì—ëŸ¬ ë©”ì‹œì§€)
  - ì‚­ì œ í™•ì¸ ë‹¤ì´ì–¼ë¡œê·¸

#### 4. ê´€ë¦¬ì ë ˆì´ì•„ì›ƒ ì—…ë°ì´íŠ¸
- **íŒŒì¼**: `frontend/src/app/admin/layout.tsx`
- **ë³€ê²½ì‚¬í•­**: "ë©”ë‰´ ê´€ë¦¬" í•­ëª© ì¶”ê°€ (ViewList ì•„ì´ì½˜)

---

## ğŸš€ ì‚¬ìš© ë°©ë²•

### 1. Backend ì‹¤í–‰

```bash
cd backend

# ê°€ìƒí™˜ê²½ í™œì„±í™”
source .venv/bin/activate  # macOS/Linux
# ë˜ëŠ”
.venv\Scripts\activate  # Windows

# ê°œë°œ ì„œë²„ ì‹¤í–‰
uvicorn app.main:app --reload --port 8000
```

### 2. Frontend ì‹¤í–‰

```bash
cd frontend

# ê°œë°œ ì„œë²„ ì‹¤í–‰
npm run dev
```

### 3. ì ‘ì†

- Frontend: http://localhost:3000
- Admin ë©”ë‰´ ê´€ë¦¬: http://localhost:3000/admin/menus
- Backend API ë¬¸ì„œ: http://localhost:8000/docs

---

## ğŸ“ ì£¼ìš” íŠ¹ì§•

### 1. Coding Guide ì¤€ìˆ˜

âœ… **í•„ìˆ˜ ê°ì‚¬ ì»¬ëŸ¼ í¬í•¨**:
- `id`, `created_at`, `created_by`, `updated_at`, `updated_by`, `is_active`, `is_deleted`
- PostgreSQLì— ë§ê²Œ `NOW()` í•¨ìˆ˜ ì‚¬ìš©

âœ… **ë³´ì•ˆ**:
- JWT ì¸ì¦ ê¸°ë°˜ (`CurrentAdminOptional` ì‚¬ìš©)
- ê°œë°œ ëª¨ë“œì—ì„œëŠ” ê¶Œí•œ ì²´í¬ ì™„í™”
- SQL Injection ë°©ì§€ (ORM ì‚¬ìš©)
- XSS ë°©ì§€ (ì…ë ¥ê°’ ê²€ì¦)

âœ… **ì—ëŸ¬ ì²˜ë¦¬**:
- í”„ë¡œë•ì…˜ í™˜ê²½ì— ë§ëŠ” ì—ëŸ¬ ë©”ì‹œì§€
- HTTP ìƒíƒœ ì½”ë“œ ì ì ˆíˆ ì‚¬ìš©

### 2. íŠ¸ë¦¬ êµ¬ì¡° ê´€ë¦¬

- **Self-Referencing Foreign Key**: `parent_id`
- **Depth ìë™ ê³„ì‚°**: ë¶€ëª¨ë¡œë¶€í„° ìƒì†
- **Path ìƒì„±**: `/1/2/3` í˜•íƒœë¡œ ê³„ì¸µ í‘œí˜„
- **ì¬ê·€ íŠ¸ë¦¬ ë¹Œë“œ**: `build_menu_tree()` í•¨ìˆ˜

### 3. Soft Delete

- `is_deleted` í”Œë˜ê·¸ë¡œ ë…¼ë¦¬ì  ì‚­ì œ
- `hard_delete` ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°ë¡œ ë¬¼ë¦¬ì  ì‚­ì œ ê°€ëŠ¥
- ì‚­ì œëœ í•­ëª©ì€ ê¸°ë³¸ì ìœ¼ë¡œ ì¡°íšŒì—ì„œ ì œì™¸

### 4. ì •ë ¬ ë° ì´ë™

- `sort_order` í•„ë“œë¡œ ë©”ë‰´ ìˆœì„œ ê´€ë¦¬
- `reorder` APIë¡œ ë“œë˜ê·¸ ì•¤ ë“œë¡­ ìˆœì„œ ë³€ê²½ ì§€ì›
- `move` APIë¡œ ë¶€ëª¨ ë³€ê²½ ë° ì¬ë°°ì¹˜

---

## ğŸ¨ UI/UX

### í™”ë©´ êµ¬ì„±

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Header: ê´€ë¦¬ì íŒ¨ë„                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚          â”‚                                          â”‚
â”‚ Sidebar  â”‚ Content Area                             â”‚
â”‚          â”‚                                          â”‚
â”‚ - ë©”ë‰´ê´€ë¦¬â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ - íšŒì›ê´€ë¦¬â”‚ â”‚ ë©”ë‰´ ëª©ë¡    â”‚ ë©”ë‰´ ìƒì„¸/ìˆ˜ì •     â”‚   â”‚
â”‚ - ...    â”‚ â”‚              â”‚                    â”‚   â”‚
â”‚          â”‚ â”‚ [ìƒˆ ë©”ë‰´]    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚   â”‚
â”‚          â”‚ â”‚              â”‚ â”‚ ë©”ë‰´ ì´ë¦„    â”‚    â”‚   â”‚
â”‚          â”‚ â”‚ â–¡ ì‹œìŠ¤í…œê´€ë¦¬ â”‚ â”‚ ë©”ë‰´ ì½”ë“œ    â”‚    â”‚   â”‚
â”‚          â”‚ â”‚ â˜‘ ë©”ë‰´ê´€ë¦¬   â”‚ â”‚ ì„¤ëª…         â”‚    â”‚   â”‚
â”‚          â”‚ â”‚ â–¡ íšŒì›ê´€ë¦¬   â”‚ â”‚ ì•„ì´ì½˜       â”‚    â”‚   â”‚
â”‚          â”‚ â”‚              â”‚ â”‚ ë§í¬ íƒ€ì…    â”‚    â”‚   â”‚
â”‚          â”‚ â”‚              â”‚ â”‚ ...          â”‚    â”‚   â”‚
â”‚          â”‚ â”‚              â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   â”‚
â”‚          â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### MUI ì»´í¬ë„ŒíŠ¸ ì‚¬ìš©

- **Grid**: ë°˜ì‘í˜• ë ˆì´ì•„ì›ƒ (ì¢Œìš° ë¶„í• )
- **Card/CardContent**: ë©”ë‰´ ëª©ë¡ ë° í¼ ì˜ì—­
- **Paper**: ë©”ë‰´ ì•„ì´í…œ (í´ë¦­ ê°€ëŠ¥)
- **TextField**: ì…ë ¥ í•„ë“œ
- **Select/MenuItem**: ë“œë¡­ë‹¤ìš´
- **Switch**: í† ê¸€ ë²„íŠ¼
- **Button**: ì•¡ì…˜ ë²„íŠ¼
- **Dialog**: ì‚­ì œ í™•ì¸
- **Alert**: ì„±ê³µ/ì—ëŸ¬ ë©”ì‹œì§€
- **Breadcrumbs**: ê²½ë¡œ í‘œì‹œ

---

## ğŸ”§ í™•ì¥ ê°€ëŠ¥ì„±

### í˜„ì¬ ì§€ì›í•˜ëŠ” ë©”ë‰´ íƒ€ì…

- `admin`: ê´€ë¦¬ì ë©”ë‰´ (êµ¬í˜„ ì™„ë£Œ)
- `site`: ì‚¬ì´íŠ¸ ì „ì²´ ë©”ë‰´ (ë¯¸êµ¬í˜„)
- `user`: ì‚¬ìš©ì ì „ìš© ë©”ë‰´ (ë¯¸êµ¬í˜„)
- `header_utility`: í—¤ë” ìœ í‹¸ë¦¬í‹° (ë¯¸êµ¬í˜„)
- `footer_utility`: í‘¸í„° ìœ í‹¸ë¦¬í‹° (ë¯¸êµ¬í˜„)
- `quick_menu`: ë¹ ë¥¸ ë©”ë‰´ (ë¯¸êµ¬í˜„)

### í–¥í›„ ì¶”ê°€ ê°€ëŠ¥í•œ ê¸°ëŠ¥

1. **ë“œë˜ê·¸ ì•¤ ë“œë¡­**: dnd-kit ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ ì‹œê°ì  ì´ë™
2. **íŠ¸ë¦¬ ë·°**: ê³„ì¸µ êµ¬ì¡° ì‹œê°í™” (í˜„ì¬ëŠ” í”Œë« ëª©ë¡)
3. **ê¶Œí•œ ìƒì„¸ ì„¤ì •**: ê·¸ë£¹ë³„, ì‚¬ìš©ìë³„ ê¶Œí•œ ë§¤í•‘
4. **ë©”ë‰´ ë¯¸ë¦¬ë³´ê¸°**: ì‹¤ì œ ë Œë”ë§ ë¯¸ë¦¬ë³´ê¸°
5. **ë©”ë‰´ ë³µì‚¬/ë¶™ì—¬ë„£ê¸°**: ë©”ë‰´ êµ¬ì¡° ë¹ ë¥¸ ë³µì œ
6. **ë©”ë‰´ ê°€ì ¸ì˜¤ê¸°/ë‚´ë³´ë‚´ê¸°**: JSON í˜•íƒœë¡œ ë°±ì—…/ë³µì›
7. **ë‹¤êµ­ì–´ ì§€ì›**: ë©”ë‰´ëª… ë‹¤êµ­ì–´ ê´€ë¦¬

---

## ğŸ“‚ íŒŒì¼ êµ¬ì¡°

### Backend

```
backend/
â”œâ”€â”€ alembic/
â”‚   â””â”€â”€ versions/
â”‚       â””â”€â”€ f72dc939c68d_add_menus_table.py
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”œâ”€â”€ __init__.py (Menu ì¶”ê°€)
â”‚   â”‚   â””â”€â”€ menu.py (ì‹ ê·œ)
â”‚   â”œâ”€â”€ schemas/
â”‚   â”‚   â”œâ”€â”€ __init__.py (Menu ìŠ¤í‚¤ë§ˆ ì¶”ê°€)
â”‚   â”‚   â””â”€â”€ menu.py (ì‹ ê·œ)
â”‚   â””â”€â”€ api/v1/
â”‚       â”œâ”€â”€ router.py (ë©”ë‰´ ë¼ìš°í„° ë“±ë¡)
â”‚       â””â”€â”€ endpoints/
â”‚           â””â”€â”€ menus.py (ì‹ ê·œ)
```

### Frontend

```
frontend/src/
â”œâ”€â”€ types/
â”‚   â”œâ”€â”€ index.ts (Menu íƒ€ì… export ì¶”ê°€)
â”‚   â””â”€â”€ menu.ts (ì‹ ê·œ)
â”œâ”€â”€ lib/
â”‚   â””â”€â”€ api.ts (Menu API ë©”ì„œë“œ ì¶”ê°€)
â””â”€â”€ app/admin/
    â”œâ”€â”€ layout.tsx (ë©”ë‰´ í•­ëª© ì¶”ê°€)
    â””â”€â”€ menus/
        â””â”€â”€ page.tsx (ì‹ ê·œ)
```

---

## âœ… í…ŒìŠ¤íŠ¸ ê°€ì´ë“œ

### 1. API í…ŒìŠ¤íŠ¸ (Swagger)

http://localhost:8000/docs ì ‘ì† í›„:

1. **ë©”ë‰´ ìƒì„±**:
   - `POST /api/v1/admin/menus`
   - Body:
     ```json
     {
       "menu_type": "admin",
       "menu_name": "ëŒ€ì‹œë³´ë“œ",
       "menu_code": "dashboard",
       "link_type": "url",
       "link_url": "/admin/dashboard",
       "permission_type": "admin"
     }
     ```

2. **ë©”ë‰´ ì¡°íšŒ**:
   - `GET /api/v1/admin/menus?menu_type=admin`

3. **ë©”ë‰´ ìˆ˜ì •**:
   - `PATCH /api/v1/admin/menus/{id}`

4. **ë©”ë‰´ ì‚­ì œ**:
   - `DELETE /api/v1/admin/menus/{id}`

### 2. Frontend í…ŒìŠ¤íŠ¸

1. http://localhost:3000/admin/menus ì ‘ì†
2. "ìƒˆ ë©”ë‰´" ë²„íŠ¼ í´ë¦­
3. ë©”ë‰´ ì •ë³´ ì…ë ¥ í›„ "ì €ì¥"
4. ìƒì„±ëœ ë©”ë‰´ í´ë¦­ â†’ ìƒì„¸ ì •ë³´ í™•ì¸
5. "ìˆ˜ì •" ë²„íŠ¼ â†’ ì •ë³´ ë³€ê²½ â†’ "ì €ì¥"
6. "ì‚­ì œ" ë²„íŠ¼ â†’ í™•ì¸ ë‹¤ì´ì–¼ë¡œê·¸ â†’ "ì‚­ì œ"

---

## ğŸ› ì•Œë ¤ì§„ ì´ìŠˆ ë° í•´ê²°

### 1. UserGroup ëª¨ë¸ ëˆ„ë½
- **ë¬¸ì œ**: Alembic ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹œ `user_groups` í…Œì´ë¸” ì°¸ì¡° ì˜¤ë¥˜
- **í•´ê²°**: `models/__init__.py`ì— `UserGroup` import ì¶”ê°€

### 2. Board í…Œì´ë¸” íƒ€ì… ë¶ˆì¼ì¹˜
- **ë¬¸ì œ**: `created_by`, `updated_by` ì»¬ëŸ¼ì´ VARCHAR â†’ UUID ë³€ê²½ í•„ìš”
- **í•´ê²°**: ë§ˆì´ê·¸ë ˆì´ì…˜ íŒŒì¼ì—ì„œ í•´ë‹¹ ë³€ê²½ ì‚¬í•­ ì œì™¸ (ê¸°ì¡´ ë°ì´í„° ë³´ì¡´)

### 3. ê°œë°œ ëª¨ë“œ ê¶Œí•œ ì²´í¬
- **í•´ê²°**: `CurrentAdminOptional` ì‚¬ìš©ìœ¼ë¡œ ê°œë°œ í™˜ê²½ì—ì„œ ì¸ì¦ ìš°íšŒ

---

## ğŸ“š ì°¸ê³  ìë£Œ

- [FastAPI ê³µì‹ ë¬¸ì„œ](https://fastapi.tiangolo.com/)
- [SQLAlchemy 2.0 ë¬¸ì„œ](https://docs.sqlalchemy.org/en/20/)
- [Next.js App Router](https://nextjs.org/docs/app)
- [MUI Components](https://mui.com/material-ui/getting-started/)
- [Alembic ë§ˆì´ê·¸ë ˆì´ì…˜](https://alembic.sqlalchemy.org/)

---

## ğŸ“ ë¬¸ì˜

êµ¬í˜„ ê´€ë ¨ ë¬¸ì˜ì‚¬í•­ì´ ìˆìœ¼ì‹œë©´ í”„ë¡œì íŠ¸ ì´ìŠˆ íŠ¸ë˜ì»¤ë¥¼ ì´ìš©í•´ì£¼ì„¸ìš”.

---

**êµ¬í˜„ ì™„ë£Œì¼**: 2026-01-09
**êµ¬í˜„ì**: Claude Sonnet 4.5
**í”„ë¡œì íŠ¸**: ìŠ¤ì¹´ì´ë™í–‰ ë³‘ì›ë™í–‰ í”Œë«í¼
